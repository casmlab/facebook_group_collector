<!DOCTYPE html>
<html>
<head>
  <title>Fetch Group</title>
  <meta charset="utf-8">
  <meta keywords="facebook group collector">
  <script src="json2.js"></script>
</head>
<body>
  <p>Hello, world!</p>
  <script>
  // setup javascript sdk
  window.fbAsyncInit = function() {
    FB.init({
      appId      : '1065187026859191',
      xfbml      : true,
      version    : 'v2.4'
    });

//     FB.getLoginStatus(function(response) {
//   if (response.status === 'connected') {
//     console.log('Logged in.');
//   }
//   else {
//     FB.login();
//   }
// });
  };

  (function(d, s, id){
     var js, fjs = d.getElementsByTagName(s)[0];
     if (d.getElementById(id)) {return;}
     js = d.createElement(s); js.id = id;
     js.src = "//connect.facebook.net/en_US/sdk.js";
     fjs.parentNode.insertBefore(js, fjs);
   }(document, 'script', 'facebook-jssdk'));

  // end setup javascript sdk
  </script>
  <script>
  // Only works after `FB.init` is called

 //  FB.getLoginStatus(function(response) {
 //  if (response.status === 'connected') {
 //    // the user is logged in and has authenticated your
 //    // app, and response.authResponse supplies
 //    // the user's ID, a valid access token, a signed
 //    // request, and the time the access token 
 //    // and signed request each expire
 //    var uid = response.authResponse.userID;
 //    var accessToken = response.authResponse.accessToken;
 //  } else if (response.status === 'not_authorized') {
 //    // the user is logged in to Facebook, 
 //    // but has not authenticated your app
 //  } else {
 //    // the user isn't logged in to Facebook.
 //  }
 // });
  </script>
  <script>
  function readData() {

      FB.getLoginStatus(function(response) {
        if (response.status === 'connected') {
          // the user is logged in and has authemticated your app
          console.log("connected");
          var uid = response.authResponse.userID;
          var accessToken = response.authResponse.accessToken;
          grabData(accessToken);
        } else {
            console.log("not logged in");
            FB.login();
            // the user isn't logged in to Facebook
          };
      });

  }

  function grabData(accessToken) {
    FB.api(
      "160475740743826/feed?fields=id,story,created_time,from,updated_time,actions,caption,application,message,message_tags,link,name,picture,place,object_id,comments{comment_count,message,id,created_time,from,comments{created_time}}",
      {fields: 'posts'},
      {access_token : accessToken},
      function (response) {
        console.log("get response");
        console.log(response);
        if (response && !response.error) {
          // console.log(response);
          var t = JSON.stringify(response);
          console.log(t);
          saveFile(t);
        } else {
          console.log("some error!");
        }
      }
    );
  }

  function saveFile(data) {
    var url = 'data:text/json;charset=utf8,' + encodeURIComponent(data);
    window.open(url, '_blank');
    window.focus();
  }  // var sur-fix = "?fields=";
  // var query = "posts{message,comments{message,comments}}";
  // var id =

  
  </script>
  <button onclick="readData()">Read Data on console and download</button>

</body>
<footer>
</footer>
</html>